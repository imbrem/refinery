--TODO: utilities for counting free variables, substituting and renaming up to free variables
